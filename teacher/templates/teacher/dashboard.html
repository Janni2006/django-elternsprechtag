{% extends "teacher/base.html" %}

{% block title %} Dashboard - Lehrer {% endblock title %}

{% block head %}{% endblock head %}

{% block content %}
<div class="row mb-3">
    <div class="container col-md-8">
        <div class="h-auto d-grid gap-3">
            {% if events|length > 0 %}
            <div class="row p-1">
                <div class="col col-8">
                    <p class="h1">Events</p>
                    <p class="text-muted">Alle Termine, die in Verbindung mit Ihnen stehen</p>
                </div>
                <div class="col col-4 d-grid gap-2 justify-content-md-end">
                    <button class="btn btn-primary p-4" type="button">Download PDF</button>
                </div>
            </div>

            <div class="accordion" id="event-accordion">
                {% for event in events %}
                <div class="accordion-item" id="event-accordion-item-{{ event.id }}">
                    <h2 class="accordion-header" id="event-accordion-heading-{{ event.id }}">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#event-accordion-collapse-{{ event.id }}" aria-expanded="false"
                            aria-controls="event-accordion-collapse-{{ event.id }}">
                            {{ event }}
                        </button>
                    </h2>
                    <div id="event-accordion-collapse-{{ event.id }}" class="accordion-collapse collapse"
                        aria-labelledby="event-accordion-heading-{{ event.id }}" data-bs-parent="#event-accordion">
                        <div class="accordion-body">
                            <strong>Startzeit: </strong>{{ event.start }} <br />
                            <strong>Elternteil: </strong>
                            {{ event.parent.first_name }} {{ event.parent.last_name }}<br />
                            <strong>Schüler:innen: </strong> {{ event.students }}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="container">
                <p class="h1">Events</p>
                <p class="text-muted">Es gibt bei Ihnen bisher keine offenen Termine</p>
            </div>
            {% endif %}
        </div>
    </div>
    <div class="container col-md-4">
        <div class="h-auto d-grid gap-3">
            <div class="container">
                <p class="h1">Anfragen</p>
                <p class="text-muted">Ihre Anfragen an einzelne Schüler</p>
            </div>

            {% if inquiries|length > 0 %}
            <div class="accordion" id="inquiry-accordion">
                {% for inquiry in inquiries %}
                <div class="accordion-item" id="inquiry-accordion-item-{{ inquiry.inquiry.id }}">
                    <h2 class="accordion-header" id="inquiry-accordion-heading-{{ inquiry.inquiry.id }}">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#inquiry-accordion-collapse-{{ inquiry.inquiry.id }}" aria-expanded="false"
                            aria-controls="inquiry-accordion-collapse-{{ inquiry.inquiry.id }}">
                            {{ inquiry.inquiry.student }}
                        </button>
                    </h2>
                    <div id="inquiry-accordion-collapse-{{ inquiry.inquiry.id }}" class="accordion-collapse collapse"
                        aria-labelledby="inquiry-accordion-heading-{{ inquiry.inquiry.id }}"
                        data-bs-parent="#inquiry-accordion">
                        <div class="accordion-body">
                            <strong>Elternteil: </strong>
                            {{ inquiry.inquiry.respondent.first_name }} {{ inquiry.inquiry.respondent.last_name }}<br />
                            <strong>Grund: </strong> {{ inquiry.inquiry.reason }}<br />
                            <strong>Event: </strong>
                            {% if inquiry.inquiry.event != null %}
                            {{inquiry.inquiry.event.start}}
                            {% else %}
                            ---
                            {% endif %}
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <a class="btn btn-primary" role="button" href="{{ inquiry.url }}">Bearbeiten</a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="card m-1">
                <div class="card-body">
                    <p class="h5 card-title">Keine Anfragen</p>
                    <p class="card-text">Sie haben keine Anfragen an Schüler:innen gestellt</p>
                </div>
            </div>
            {% endif %}
            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <a class="btn btn-primary" role="button" href="{% url 'teacher_students_list' %}">Anfrage stellen</a>
            </div>
        </div>
    </div>
</div>
{% endblock content %}